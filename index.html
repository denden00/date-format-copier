
<!doctype html>
<html lang="ja">
<head>
  <!-- åŸºæœ¬ -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Google Search Console æ‰€æœ‰æ¨©ç¢ºèª -->
  <meta name="google-site-verification" content="sf0AdAiy1URd-tlrBxYnXNdUkTInJIr6P2Gv8PNPwsY" />

  <!-- ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆæ¤œç´¢å‘ã‘ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚ã‚‹ï¼‰ -->
  <title>æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›ï¼†ã‚³ãƒ”ãƒ¼ï½œç„¡æ–™ãƒ„ãƒ¼ãƒ«ï¼ˆæ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«å¯¾å¿œï¼‰</title>

  <!-- ãƒ¡ã‚¿ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ï¼šæ¤œç´¢çµæœã®èª¬æ˜ -->
  <meta name="description" content="é¸ã‚“ã æ—¥ä»˜ã‚„æ™‚åˆ»ã‚’ã€ã‚ˆãä½¿ã†å½¢å¼ã«ã™ãå¤‰æ›ã—ã¦ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒ”ãƒ¼ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚æ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«ï¼ˆå¹´æœˆæ—¥ã€æ›œæ—¥ï¼‰å¯¾å¿œã€‚ãƒ“ã‚¸ãƒã‚¹æ–‡æ›¸ãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»è³‡æ–™ä½œæˆã«ä¾¿åˆ©ã€‚" />

  <!-- ï¼ˆä»»æ„ï¼‰ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼šåŠ¹æœã¯é™å®šçš„ã ãŒè£œåŠ©ã§ -->
  <meta name="keywords" content="æ—¥ä»˜,æ—¥æ™‚,ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ,å¤‰æ›,ã‚³ãƒ”ãƒ¼,ç„¡æ–™ãƒ„ãƒ¼ãƒ«,æ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«,ISO 8601,yyyyMMdd,yyyy-MM-dd" />

  <!-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®åŸºæœ¬æ–¹é‡ -->
  <meta name="robots" content="index,follow" />

  <!-- Canonicalï¼ˆé‡è¤‡URLå¯¾ç­–ï¼‰ -->
  <link rel="canonical" href="https://denden00.github.io/date-format-copier/" /> 

  <!-- OGPï¼ˆSNSã‚·ã‚§ã‚¢ç”¨ï¼‰ -->
  <meta property="og:title" content="æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›ï¼†ã‚³ãƒ”ãƒ¼ï½œç„¡æ–™ãƒ„ãƒ¼ãƒ«ï¼ˆæ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«å¯¾å¿œï¼‰" />
  <meta property="og:description" content="æ—¥ä»˜ã‚„æ™‚åˆ»ã‚’å„ç¨®å½¢å¼ã«å¤‰æ›ã—ã€ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒ”ãƒ¼ã€‚æ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«å¯¾å¿œã€‚ãƒ“ã‚¸ãƒã‚¹æ–‡æ›¸ãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»è³‡æ–™ä½œæˆã«ä¾¿åˆ©ã€‚" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://denden00.github.io/date-format-copier/" />
  <meta property="og:image" content="https://denden00.github.io/date-format-copier/og-image.png" />
  <meta property="og:locale" content="ja_JP" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›ï¼†ã‚³ãƒ”ãƒ¼ï½œç„¡æ–™ãƒ„ãƒ¼ãƒ«ï¼ˆæ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«å¯¾å¿œï¼‰" />
  <meta name="twitter:description" content="æ—¥ä»˜ã‚„æ™‚åˆ»ã‚’å„ç¨®å½¢å¼ã«å¤‰æ›ã—ã€ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒ”ãƒ¼ã€‚æ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«å¯¾å¿œã€‚" />
  <meta name="twitter:url" content="https://denden00.github.io/date-format-copier/" />
  <meta name="twitter:image" content="https://denden00.github.io/date-format-copier/og-image.png" />

  <!-- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ç­‰ï¼ˆä»»æ„ï¼‰ -->
  <link rel="icon" href="favicon.ico">
  <meta name="theme-color" content="#2563eb" />

  <!-- æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆJSON-LD / WebApplicationï¼‰ -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›ï¼†ã‚³ãƒ”ãƒ¼",
    "description": "é¸ã‚“ã æ—¥ä»˜ã‚„æ™‚åˆ»ã‚’å„ç¨®å½¢å¼ã«å¤‰æ›ã—ã¦ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒ”ãƒ¼ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚æ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«å¯¾å¿œã€‚",
    "applicationCategory": "Utility",
    "operatingSystem": "All",
    "url": "https://denden00.github.io/date-format-copier/",
    "inLanguage": "ja-JP"
  }
  </script>

  <!-- UIã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¯å®‰å®šç‰ˆï¼‰ -->
  <style>
    :root {
      --bg: #ffffff;
      --panel: #f8fafc;
      --text: #111827;
      --muted: #6b7280;
      --primary: #2563eb;
      --primary-700: #1d4ed8;
      --border: #e5e7eb;
      --success-bg: #dcfce7;
      --success-text: #065f46;
      --accent-bg: #eef2ff;
      --accent-border: #e0e7ff;
      --shadow: rgba(0,0,0,0.08);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }
    .container { max-width: 980px; margin: 28px auto; padding: 0 16px; }

    header { margin-bottom: 16px; }
    .title-wrap {
      background: var(--accent-bg);
      border: 1px solid var(--accent-border);
      border-radius: 20px;
      padding: 18px 20px;
      box-shadow: 0 8px 18px var(--shadow);
    }
    h1 {
      margin: 0 0 10px;
      font-size: 1.9rem;
      font-weight: 800;
      color: var(--primary);
      display: flex; align-items: center; gap: 10px; letter-spacing: .02em;
    }
    h1 .logo {
      display: inline-flex; width: 28px; height: 28px;
      align-items: center; justify-content: center;
      border-radius: 8px; background: var(--primary); color: #fff; font-size: 16px;
      box-shadow: 0 4px 10px var(--shadow);
    }
    .subdesc { margin: 0; font-size: 1.05rem; color: var(--muted); }
    .subdesc p { margin: 0.4em 0; }

    .controls {
      display: grid; gap: 12px; background: var(--panel);
      border: 1px solid var(--border); border-radius: 16px; padding: 18px;
      position: sticky; top: 0; z-index: 10; box-shadow: 0 6px 18px var(--shadow);
    }
    .headline {
      display: inline-flex; align-items: center; gap: 8px; font-weight: 700;
      color: var(--primary); background: #eaf2ff; border: 1px solid #dbeafe;
      border-radius: 999px; padding: 6px 12px; width: fit-content; white-space: nowrap;
    }
    .headline .icon {
      display: inline-flex; width: 18px; height: 18px; align-items: center; justify-content: center;
      border-radius: 50%; background: var(--primary); color: #fff; font-size: 12px;
    }
    #dtInput {
      background: #fff; color: var(--text);
      border: 2px solid #c7d2fe; border-radius: 12px; padding: 18px 20px; font-size: 1.2rem; font-weight: 600;
      outline: none; box-shadow: 0 8px 18px var(--shadow); cursor: pointer;
    }
    #dtInput:hover { border-color: #93c5fd; box-shadow: 0 10px 22px var(--shadow); }
    #dtInput:focus { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(37,99,235,.15), 0 10px 22px var(--shadow); }
    .help { font-size: 0.95rem; color: var(--muted); }

    .formats { margin-top: 16px; display: grid; gap: 12px; }
    .row {
      position: relative; display: flex; align-items: stretch; gap: 12px;
      background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 12px 14px;
      box-shadow: 0 4px 12px var(--shadow); overflow: hidden;
    }
    .fmt-label {
      flex: 0 0 auto; min-width: 190px; max-width: 280px; white-space: nowrap; align-self: center;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; color: var(--muted); font-size: 0.95rem;
    }
    .row .value { flex: 1 1 auto; min-width: 120px; display: flex; }
    .row .value input[type="text"] {
      width: 100%; background: #fff; color: var(--text); border: 1px solid var(--border);
      border-radius: 10px; padding: 10px 12px; outline: none;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; overflow: hidden; text-overflow: ellipsis;
    }
    .row .actions { flex: 0 0 auto; display: flex; align-items: center; }
    button.copy {
      background: var(--primary); color: #fff; border: none; border-radius: 10px;
      padding: 10px 14px; cursor: pointer; font-weight: 700; white-space: nowrap; box-shadow: 0 4px 10px var(--shadow);
    }
    button.copy:hover { background: var(--primary-700); }

    .local-toast {
      position: absolute; right: 14px; top: 8px;
      background: var(--success-bg); color: var(--success-text);
      padding: 6px 10px; border-radius: 8px; font-size: 0.9rem; font-weight: 700;
      box-shadow: 0 4px 12px var(--shadow); opacity: 0; transform: translateY(-8px);
      transition: opacity .18s ease, transform .18s ease; border: 1px solid #bbf7d0; white-space: nowrap; pointer-events: none;
    }
    .local-toast.show { opacity: 1; transform: translateY(0); }

    .custom {
      margin-top: 8px; background: var(--panel); border: 1px solid var(--border);
      border-radius: 16px; padding: 14px; display: grid; gap: 12px; box-shadow: 0 6px 18px var(--shadow);
    }
    .custom-grid { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; }
    .custom-grid > input[type="text"] {
      flex: 1 1 280px; min-width: 180px; background: #fff; border: 1px solid var(--border);
      border-radius: 10px; padding: 10px 12px;
    }
    .custom-grid > button.copy { flex: 0 0 auto; }

    .picker-container { position: relative; }
    .overlay {
      position: absolute; top: calc(100% + 8px); left: 0; background: #fff;
      border: 1px solid var(--border); border-radius: 14px; box-shadow: 0 12px 28px var(--shadow);
      width: 460px; padding: 16px; display: none; z-index: 100;
    }
    .overlay.show { display: block; }
    .overlay-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .overlay-header .month { font-weight: 700; font-size: 1.12rem; white-space: nowrap; }
    .overlay-header button {
      background: #f1f5f9; color: var(--text); border: 1px solid var(--border);
      border-radius: 8px; padding: 8px 12px; cursor: pointer; white-space: nowrap;
    }
    .overlay-header button:hover { background: #e2e8f0; }
    .calendar-grid { display: grid; grid-template-columns: repeat(7,1fr); gap: 8px; margin-bottom: 10px; }
    .dow { text-align: center; color: var(--muted); font-size: 0.92rem; white-space: nowrap; }
    .day {
      text-align: center; padding: 12px 0; border-radius: 10px; cursor: pointer;
      border: 1px solid transparent; background: #fff; box-shadow: 0 2px 8px var(--shadow);
      font-size: 1.05rem; user-select: none;
    }
    .day:hover { background: #f8fafc; border-color: #c7d2fe; }
    .day.disabled { color: #9ca3af; cursor: default; background: transparent; box-shadow: none; }
    .day.today { border-color: #93c5fd; }

    .time-panel { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 12px; }
    .time-panel input {
      background: #fff; color: var(--text); border: 1px solid var(--border); border-radius: 10px;
      padding: 12px; text-align: center; outline: none; box-shadow: 0 2px 8px var(--shadow); font-size: 1.05rem;
    }

    @media (max-width: 720px) {
      .row { flex-direction: column; align-items: stretch; }
      .fmt-label { min-width: 0; max-width: none; }
      .local-toast { right: 12px; top: 6px; }
      .overlay { width: 96vw; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- è¦‹å‡ºã—ï¼ˆå¼·èª¿ï¼‰ -->
    <header>
      <div class="title-wrap">
        <h1><span class="logo">â±</span>æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›ï¼†ã‚³ãƒ”ãƒ¼</h1>
        <div class="subdesc">
          <p>ã“ã®ã‚µã‚¤ãƒˆã¯ã€é¸ã‚“ã ã€Œæ—¥ä»˜ãƒ»æ™‚åˆ»ã€ã‚’ã‚ˆãä½¿ã†æ›¸å¼ã«å¤‰æ›ã—ã¦ã€ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒ”ãƒ¼ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚</p>
          <p>ãƒ“ã‚¸ãƒã‚¹æ–‡æ›¸ã€ãƒ¡ãƒ¼ãƒ«ã€å ±å‘Šæ›¸ã€è³‡æ–™ä½œæˆãªã©ã§ã€çµ±ä¸€ã—ãŸæ—¥ä»˜è¡¨è¨˜ã‚’ã™ã°ã‚„ãä½œã‚Œã¾ã™ã€‚</p>
        </div>
      </div>
    </header>

    <!-- ä¸Šéƒ¨ï¼šè‡ªå‰ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ä»˜ãã®æ—¥æ™‚å…¥åŠ›ï¼ˆå¼·èª¿ï¼‰ -->
    <section class="controls" aria-label="æ—¥æ™‚é¸æŠ">
      <div class="headline"><span class="icon">ğŸ—“</span>æ—¥æ™‚ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºï¼‰</div>
      <input id="dtInput" type="text" readonly aria-describedby="descDt" />
      <small id="descDt" class="help">æ—¥ä»˜ã‚¯ãƒªãƒƒã‚¯ï¼æ™‚åˆ»å…¥åŠ›ã®å¤‰æ›´ã§å³åæ˜ ã—ã¾ã™ã€‚</small>

      <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ -->
      <div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-label="æ—¥æ™‚ãƒ”ãƒƒã‚«ãƒ¼">
        <div class="overlay-header">
          <button id="prevMonth" aria-label="å‰ã®æœˆ">â† å‰</button>
          <div class="month" id="monthLabel"></div>
          <button id="nextMonth" aria-label="æ¬¡ã®æœˆ">æ¬¡ â†’</button>
        </div>
        <div class="calendar-grid" id="calendarHeader"></div>
        <div class="calendar-grid" id="calendarDays"></div>
        <div class="time-panel">
          <input id="hourInput" type="number" min="0" max="23" step="1" placeholder="HH" aria-label="æ™‚ (0-23)" />
          <input id="minuteInput" type="number" min="0" max="59" step="1" placeholder="mm" aria-label="åˆ† (0-59)" />
          <input id="secondInput" type="number" min="0" max="59" step="1" placeholder="ss" aria-label="ç§’ (0-59)" />
        </div>
      </div>
    </section>

    <!-- ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¸€è¦§ -->
    <section class="formats" id="formatList" aria-live="polite"></section>

    <!-- ã‚«ã‚¹ã‚¿ãƒ å½¢å¼ -->
    <section class="custom" aria-label="ã‚«ã‚¹ã‚¿ãƒ å½¢å¼">
      <label for="customPattern">ã‚«ã‚¹ã‚¿ãƒ å½¢å¼ãƒ‘ã‚¿ãƒ¼ãƒ³</label>
      <input id="customPattern" type="text" placeholder="ä¾‹: yyyy/MM/dd HH:mm:ss 'JST'" />
      <div class="custom-grid">
        <input id="customResult" type="text" readonly />
        <button class="copy" id="copyCustom">ã‚³ãƒ”ãƒ¼</button>
        <button class="copy" id="addCustom">ä¸€è¦§ã«è¿½åŠ </button>
      </div>
    </section>
  </div>

  <script>
    // ===== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ =====
    const pad = (n, w = 2) => String(n).padStart(w, '0');
    const WEEKDAYS = ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'];
    function tzOffsetString(d) {
      const offsetMin = -d.getTimezoneOffset();
      const sign = offsetMin >= 0 ? '+' : '-';
      const abs = Math.abs(offsetMin);
      const hh = pad(Math.floor(abs / 60));
      const mm = pad(abs % 60);
      return `${sign}${hh}:${mm}`;
    }

    // ===== ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ =====
    function formatDate(d, pattern) {
      if (pattern === 'ISO_LOCAL') {
        return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}${tzOffsetString(d)}`;
      }
      const rep = {
        'yyyy': () => pad(d.getFullYear(), 4),
        'MM':   () => pad(d.getMonth()+1),
        'dd':   () => pad(d.getDate()),
        'HH':   () => pad(d.getHours()),
        'mm':   () => pad(d.getMinutes()),
        'ss':   () => pad(d.getSeconds()),
        'E':    () => WEEKDAYS[d.getDay()],
      };
      let out = pattern;
      Object.keys(rep).sort((a,b) => b.length - a.length).forEach(tok => {
        out = out.replace(new RegExp(tok, 'g'), rep[tok]);
      });
      return out;
    }

    // ===== ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ =====
    async function copyText(text) {
      try {
        await navigator.clipboard.writeText(text);
        return true;
      } catch {
        const ta = document.createElement('textarea');
        ta.value = text; document.body.appendChild(ta); ta.select();
        let ok = false;
        try { ok = document.execCommand('copy'); } finally { document.body.removeChild(ta); }
        return ok;
      }
    }

    // ===== ãƒ­ãƒ¼ã‚«ãƒ«ãƒˆãƒ¼ã‚¹ãƒˆï¼ˆè¡Œå³ä¸Šå›ºå®šï¼‰ =====
    function showLocalToast(anchorBtn, msg) {
      const row = anchorBtn.closest('.row'); if (!row) return;
      row.querySelectorAll('.local-toast').forEach(el => el.remove());
      const toast = document.createElement('div');
      toast.className = 'local-toast'; toast.textContent = msg;
      row.appendChild(toast);
      requestAnimationFrame(() => toast.classList.add('show'));
      setTimeout(() => { toast.classList.remove('show'); setTimeout(() => toast.remove(), 200); }, 1600);
    }

    // ===== æ—¥æ™‚çŠ¶æ…‹ =====
    let state = { viewYear: 0, viewMonth: 0, sel: new Date() };

    // ===== ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼UI =====
    const dtInput = document.getElementById('dtInput');
    const overlay = document.getElementById('overlay');
    const monthLabel = document.getElementById('monthLabel');
    const calHeader = document.getElementById('calendarHeader');
    const calDays = document.getElementById('calendarDays');
    const hourInput = document.getElementById('hourInput');
    const minuteInput = document.getElementById('minuteInput');
    const secondInput = document.getElementById('secondInput');

    function openOverlay() {
      overlay.classList.add('show');
      renderCalendar();
      hourInput.value = pad(state.sel.getHours());
      minuteInput.value = pad(state.sel.getMinutes());
      secondInput.value = pad(state.sel.getSeconds());
      hourInput.focus();
      document.addEventListener('mousedown', handleOutsideClick);
      document.addEventListener('keydown', handleEsc);
    }
    function closeOverlay() {
      overlay.classList.remove('show');
      document.removeEventListener('mousedown', handleOutsideClick);
      document.removeEventListener('keydown', handleEsc);
    }
    function handleOutsideClick(e) { if (!overlay.contains(e.target) && e.target !== dtInput) closeOverlay(); }
    function handleEsc(e) { if (e.key === 'Escape') closeOverlay(); }

    function initHeaderRow() {
      calHeader.innerHTML = '';
      ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'].forEach(dow => {
        const el = document.createElement('div'); el.className = 'dow'; el.textContent = dow; calHeader.appendChild(el);
      });
    }

    function renderCalendar() {
      const y = state.viewYear, m = state.viewMonth;
      monthLabel.textContent = `${y}å¹´ ${pad(m+1)}æœˆ`;
      calDays.innerHTML = '';

      const first = new Date(y, m, 1);
      const startDow = first.getDay();
      const daysInMonth = new Date(y, m+1, 0).getDate();

      for (let i = 0; i < startDow; i++) {
        const ph = document.createElement('div'); ph.className = 'day disabled'; ph.textContent = ''; calDays.appendChild(ph);
      }
      const today = new Date();
      for (let d = 1; d <= daysInMonth; d++) {
        const el = document.createElement('div');
        el.className = 'day';
        if (today.getFullYear() === y && today.getMonth() === m && today.getDate() === d) el.classList.add('today');
        el.textContent = d;
        el.addEventListener('click', () => {
          const hh = parseInt(hourInput.value || '0', 10);
          const mm = parseInt(minuteInput.value || '0', 10);
          const ss = parseInt(secondInput.value || '0', 10);
          state.sel = new Date(y, m, d, hh, mm, ss, 0);
          dtInput.value = `${y}-${pad(m+1)}-${pad(d)} ${pad(hh)}:${pad(mm)}:${pad(ss)}`;
          closeOverlay();
          renderFormats();
        });
        calDays.appendChild(el);
      }
    }

    document.getElementById('prevMonth').addEventListener('click', () => {
      if (state.viewMonth === 0) { state.viewMonth = 11; state.viewYear--; } else { state.viewMonth--; }
      renderCalendar();
    });
    document.getElementById('nextMonth').addEventListener('click', () => {
      if (state.viewMonth === 11) { state.viewMonth = 0; state.viewYear++; } else { state.viewMonth++; }
      renderCalendar();
    });

    dtInput.addEventListener('click', openOverlay);
    ['input', 'change'].forEach(ev => {
      hourInput.addEventListener(ev, applyTimeInstant);
      minuteInput.addEventListener(ev, applyTimeInstant);
      secondInput.addEventListener(ev, applyTimeInstant);
    });
    function applyTimeInstant() {
      const hh = clamp(parseInt(hourInput.value || '0', 10), 0, 23);
      const mm = clamp(parseInt(minuteInput.value || '0', 10), 0, 59);
      const ss = clamp(parseInt(secondInput.value || '0', 10), 0, 59);
      hourInput.value = pad(hh); minuteInput.value = pad(mm); secondInput.value = pad(ss);
      const y = state.sel.getFullYear(), m = state.sel.getMonth(), d = state.sel.getDate();
      state.sel = new Date(y, m, d, hh, mm, ss, 0);
      dtInput.value = `${y}-${pad(m+1)}-${pad(d)} ${pad(hh)}:${pad(mm)}:${pad(ss)}`;
      renderFormats();
    }
    function clamp(n, min, max) { return Math.max(min, Math.min(max, isNaN(n) ? min : n)); }

    (function initPicker() {
      const now = new Date();
      state.sel = now; state.viewYear = now.getFullYear(); state.viewMonth = now.getMonth();
      dtInput.value = `${now.getFullYear()}-${pad(now.getMonth()+1)}-${pad(now.getDate())} ${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;
      initHeaderRow(); renderCalendar();
    })();

    // ===== ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä¸€è¦§ =====
    const FORMATS = [
      { label: 'yyyyMMdd',                      pattern: 'yyyyMMdd' },
      { label: 'æ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«ï¼ˆæ—¥ä»˜+æ›œæ—¥ï¼‰',   pattern: 'yyyyå¹´MMæœˆddæ—¥(E)' },
      { label: 'æ—¥æœ¬èªãƒ­ã‚±ãƒ¼ãƒ«ï¼ˆæ—¥ä»˜ï¼‰',         pattern: 'yyyyå¹´MMæœˆddæ—¥' },
      { label: 'yyyy-MM-dd',                    pattern: 'yyyy-MM-dd' },
      { label: 'yyyy/MM/dd',                    pattern: 'yyyy/MM/dd' },
      { label: 'HH:mm:ss',                      pattern: 'HH:mm:ss' },
      { label: 'yyyy/MM/dd HH:mm',              pattern: 'yyyy/MM/dd HH:mm' },
      { label: 'yyyy/MM/dd HH:mm:ss',           pattern: 'yyyy/MM/dd HH:mm:ss' },
      { label: 'ISO 8601 (ãƒ­ãƒ¼ã‚«ãƒ«)',           pattern: 'ISO_LOCAL' },
      { label: 'yyyy-MM-dd HH:mm:ss',           pattern: 'yyyy-MM-dd HH:mm:ss' }
    ];

    function renderFormats() {
      const list = document.getElementById('formatList');
      list.innerHTML = '';
      const d = state.sel;

      FORMATS.forEach(fmt => {
        const row = document.createElement('div');
        row.className = 'row';

        const label = document.createElement('div');
        label.className = 'fmt-label';
        label.textContent = fmt.label;

        const valueWrap = document.createElement('div');
        valueWrap.className = 'value';
        const input = document.createElement('input');
        input.type = 'text';
        input.readOnly = true;
        input.value = formatDate(d, fmt.pattern);
        valueWrap.appendChild(input);

        const actions = document.createElement('div');
        actions.className = 'actions';
        const btn = document.createElement('button');
        btn.className = 'copy';
        btn.textContent = 'ã‚³ãƒ”ãƒ¼';
        btn.addEventListener('click', async () => {
          const ok = await copyText(input.value);
          showLocalToast(btn, ok ? 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ' : 'ã‚³ãƒ”ãƒ¼ã«å¤±æ•—');
        });
        actions.appendChild(btn);

        row.appendChild(label);
        row.appendChild(valueWrap);
        row.appendChild(actions);

        list.appendChild(row);
      });

      // ã‚«ã‚¹ã‚¿ãƒ çµæœã‚‚æ›´æ–°
      const patt = document.getElementById('customPattern').value.trim();
      const customResultEl = document.getElementById('customResult');
      customResultEl.value = patt ? formatDate(d, patt) : '';
    }

    // ã‚«ã‚¹ã‚¿ãƒ å½¢å¼
    document.getElementById('copyCustom').addEventListener('click', async (e) => {
      const v = document.getElementById('customResult').value;
      if (!v) return;
      const ok = await copyText(v);
      showLocalToast(e.currentTarget, ok ? 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ' : 'ã‚³ãƒ”ãƒ¼ã«å¤±æ•—');
    });
    document.getElementById('addCustom').addEventListener('click', () => {
      const pattEl = document.getElementById('customPattern');
      const patt = pattEl.value.trim();
      if (!patt) {
        showLocalToast(document.getElementById('addCustom'), 'ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒæœªå…¥åŠ›ã§ã™');
        return;
      }
      FORMATS.push({ label: patt, pattern: patt });
      renderFormats();
      showLocalToast(document.getElementById('addCustom'), 'ä¸€è¦§ã«è¿½åŠ ã—ã¾ã—ãŸ');
    });
    document.getElementById('customPattern').addEventListener('input', () => {
      const patt = document.getElementById('customPattern').value.trim();
           const d = state.sel;
      document.getElementById('customResult').value = patt ? formatDate(d, patt) : '';
    });

    // åˆå›ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    renderFormats();
  </script>
</body>
